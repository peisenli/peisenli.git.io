<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>MPI Programming Project | 帅的如此过分</title><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><script>var GLOBAL = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><link rel="icon" href="/favicon.ico"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">空空</div><div class="author-info__description text-center">非宁静无以致远，非淡泊无以明志</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">13</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">12</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2019/05/12/5cd78b8a60164.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">帅的如此过分</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">MPI Programming Project</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-07-13 </time></div></div></div><div class="layout" id="content-inner"><article id="post"><div id="post-content"><p>一、实验目的<br>1、掌握分布式并行计算基础<br>2、掌握MPI分布式并行基本操作<br>3、利用MPI进行程序设计，寻找1000000000以内的素数<br>二、实验环境<br>PC、Ubuntu16.04、MPICH<br>三、实验要求<br>Part 1: Modify the parallel Sieve of Eratosthenes program in class so that the program  does NOT set aside memory for even integers.<br><a id="more"></a><br>Part 2: Modify the parallel Sieve of Eratosthenes program in Part 1 so that each process of the program finds its own sieving primes via local computations instead of broadcasts.<br>四、实验步骤<br>1、在进行MPI程序设计之前确保Ubuntu、GCC环境可用之后再进行MPICH安装，如下所示安装GCC环境后确保正常。<br><img src="https://i.loli.net/2019/05/11/5cd6d2bbde6c0.png" alt="1.png"><br>2、进行MPI程序设计需要进行MPICH安装，直接使用sudo apt-get install –y mpich,如下图所示，已经安装完成。<br><img src="https://i.loli.net/2019/05/11/5cd6d2bb5e7b7.png" alt="图片1.png"><br>安装完成后进行MPI环境测试，确保正常使用，使用mpicc –v进行查看是否安装成功。<br><img src="https://i.loli.net/2019/05/11/5cd6d2bbeee22.png" alt="图片2.png"><br>3、使用老师所给的例程进行环境测试，进行编译运行，编译如下：<br><img src="https://i.loli.net/2019/05/11/5cd6d2bb9a97f.png" alt="图片3.png"><br>使用mpicc sieve0.c –o sieve0.o –lm命令后生成可执行文件sieve.o，使用mpirun –np 8 ./sieve.o 10000000000进行测试出现一下情况。<br><img src="https://i.loli.net/2019/05/11/5cd6d2bbb5feb.png" alt="图片4.png"><br>需要在使用此命令行时添加参数–allow-run-as-root后正常，环境安装完成。当改变参数时发现程序运行时间无多大变化，如下所示：<br><img src="https://i.loli.net/2019/05/11/5cd6d2bbb31a7.png" alt="图片5.png"><br>进行排查后发现自己的电脑的参数无法达到8进程所以使用4进程和8进程时间无多大区别，弄清自己PC的型号最大为4个进程再进行实验设计。<br><img src="https://i.loli.net/2019/05/11/5cd6d39d6f679.png" alt="图片6.png"><br>4、根据实验要求进行程序设计，完成Part1内容，预先对寻求素数中的偶数进行移除处理，不再为偶数进行计算。当移除偶数时，需要对每个进程中存取数组进行从新定义，每个进程的最低值和最高值如下所示：<br><img src="https://i.loli.net/2019/05/11/5cd6d39d71936.png" alt="图片7.png"><br>由于数据每个进程分配会出现不一致性，其处理方式如下所示：</p>
<pre><code>proc0_size = (n - 1) / p;
if ((3 + 2*(proc0_size-1)) &lt; (int) sqrt((double) (3+2*(n-1)))) 
{
  if (!id) printf (&quot;Too many processes\n&quot;);
  MPI_Finalize();
  exit (1);
}
</code></pre><p>Part1之中去除偶数之后在进程中进行计算的核心代码如下所示：<br><img src="https://i.loli.net/2019/05/11/5cd6d39d864d7.png" alt="图片8.png"><br>5、根据实验要求对Part2进行程序设计，其主要修改如下图所示，对每个进程的分配如下所示：<br><img src="https://i.loli.net/2019/05/11/5cd6d39d82ba9.png" alt="图片9.png"><br>在原来设计的基础之上不进行数据广播，需要进行进程本地内存使用保存数据，在每个进程中进行素数检查。<br><img src="https://i.loli.net/2019/05/11/5cd6d39d952df.png" alt="图片10.png"><br>6、根据具体的实验进行对比，完成MPI实验报告设计<br>五、实验结果<br>根据不同的实验方法进行程序设计，在具体的实验中得到实验结果，时间(s)效果如下所示：<br>|process     |Sieve0         |Part1            | Part2       |<br>| ——–   | —–:        | :—-:       | :—–:     |<br>|2             |209.828280     |108.456367    |343.496301   |<br>|4             |182.311808     |96.609751        |202.671327   |<br><img src="https://i.loli.net/2019/05/11/5cd6d39dbbfe0.png" alt="图片11.png"></p>
</div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MPICH-分布式/">MPICH  分布式</a></div></article><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/07/13/The-application-of-machine-learning-in-network-security/"><i class="fa fa-chevron-left">  </i><span>The application of machine learning in network security</span></a></div><div class="next-post pull-right"><a href="/2019/05/11/Chat-based-on-Socket/"><span>Chat based on Socket</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">©2016 - 2019 By 空空</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span> |  </span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/fancybox.js"></script><script src="/js/sidebar.js"></script><script src="/js/copy.js"></script><script src="/js/fireworks.js"></script><script src="/js/transition.js"></script><script src="/js/scroll.js"></script><script src="/js/head.js"></script></body></html>